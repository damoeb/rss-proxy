<div class="playground">

  <div style="flex:1; display: flex;">
    <div style="width: 500px; display: flex; flex-direction: column">
      <a (click)="resetAll()" class="button" style="text-align: center">Reset Changes</a>
      <div style="flex: 1 100px; overflow-y: auto">
        <div class="form">
          <p class="wizard_section"><strong>1.</strong> Please enter the URL of the website you want an RSS Feed from.</p>
          <ng-form (ngSubmit)="parseFromUrl()">
            <div style="text-align: left" class="row">
              <div class="tooltip bottom col-lg-8" aria-label="The URL you want to RSSify">
                <input [(ngModel)]="url"
                       type="url"
                       [ngClass]="{'active': !hasResults}"
                       style="width: 100%"
                       autofocus
                       name="url"
                       [autofocus]="true"
                       autocomplete="off"
                       required="true"
                       (keyup.enter)="parseFromUrl()"
                       placeholder="Enter the Url to convert into RSS">
              </div>
              <div class="col-lg-4">
                <a href="javascript:void(0)" class="button secondary" (click)="parseFromUrl()">
                  Explore Feed
                </a>
              </div>
            </div>
            <div>

              <div *ngIf="!isLoading && !hasResults && history.length > 0">
                <p><strong>Previous Queries</strong></p>
                <p *ngFor="let url of history">
                  <a href="javascript:void(0)" (click)="parseFromHistoryUrl(url)">{{ url }}</a>
                </p>
              </div>
            </div>
          </ng-form>
        </div>

        <div *ngIf="feeds?.length > 0">
          <p class="wizard_section"><strong>2.</strong> Choose a feed</p>
          <p>Native Feeds Found in DOM:</p>
          <ul class="list-of-feeds">
            <li *ngFor="let feed of feeds"><a [href]="feed.url" target="_blank">{{ feed.name }}</a></li>
          </ul>
        </div>

        <div *ngIf="rules?.length > 0" style="margin-top: 10px">
          <p>There are {{rules?.length}} feeds in this site, pick one:</p>
          <ol class="list-of-feeds">
            <li *ngFor="let rule of rules?.slice(0, 15); let i = index "
                class="rule tooltip"
                style="display: block"
                aria-label="Try to visualize and scroll to articles in website"
                [ngClass]="{'active': isCurrentRule(rule)}"
                (click)="applyRule(rule)">
              <a href="javascript:void(0)">Feed with <strong>{{ rule.count }}</strong> articles</a>
              <span *ngIf="i === 0">
                <strong> - highest score</strong>
              </span>
            </li>
          </ol>
        </div>

        <div *ngIf="currentRule">
          <p class="wizard_section"><strong>3.</strong> Filter the feed</p>
          <ul style="list-style: none">
            <li><input type="checkbox" [(ngModel)]="excludeItemsThatContain"> Remove items that contain <a href="https://github.com/damoeb/rss-proxy/wiki/Filters#text-filter" target="_blank">one of</a> (comma separated) <input type="text" name="excludeItemsThatContainTexts" [(ngModel)]="excludeItemsThatContainTexts"></li>
<!--            <li><input type="checkbox" checked> Remove items with <a href="">odd content structure</a></li>-->
            <li><input type="checkbox" [(ngModel)]="excludeBrokenItems"> Remove items that contain <a href="https://github.com/damoeb/rss-proxy/wiki/Filters#bad-content-filter" target="_blank">no relevant text</a></li>
          </ul>

        </div>

        <div style="display:flex;justify-content:center; align-items:center;"
             *ngIf="isLoading && !iframeLoaded">
          <div class="spinner"></div>
        </div>
      </div>
      <div [ngClass]="{'feed-specified': currentRule}"
           style="border-top: 1px solid black; height: 150px">
        <div class="feed-url">
          <a *ngIf="currentRule" class="button secondary large" [href]="getFeedUrl()" target="_blank">Your ATOM Feed</a>
          <h3 *ngIf="!currentRule">Your ATOM Feed not yet specified</h3>
        </div>
        <div class="playground__footer">
          <a href="https://github.com/damoeb/rss-proxy">rss-proxy</a> v. {{ getVersions().version }}@{{ getVersions().revision }} build on {{ getBuildDate() }}
          <a href="https://twitter.com/damoeb">contact</a>
        </div>
      </div>
    </div>

    <div style="flex: 1; display: flex; flex-direction: column; border-left: 1px solid black; background: white">

      <div style="display:flex;justify-content:center; align-items:center;"
           *ngIf="isLoading && !iframeLoaded">
        <div class="spinner"></div>
      </div>

      <div *ngIf="error">
        {{error}}
      </div>

      <div class="playground__panels">

        <!-- Visualization --------------------------------------------------------------------------------------------- -->

        <iframe [src]="proxyUrl"
                *ngIf="proxyUrl"
                [hidden]="isLoading"
                #iframeElement
                (load)="onIframeLoad()"
                sandbox="allow-scripts allow-same-origin allow-scripts"
                style="flex: 1; border: none"></iframe>

      </div>
    </div>
  </div>
</div>
